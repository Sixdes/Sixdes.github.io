<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
      Image Feature extraction example | Yao&#39;s station 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="John Doe">
    
    

    <meta name="description" content="关于图像特征提取的几个小栗子:">
<meta property="og:type" content="article">
<meta property="og:title" content="Image Feature extraction example | Yao's station">
<meta property="og:url" content="http://yoursite.com/2017/12/26/图像特征提取实例/index.html">
<meta property="og:site_name" content="Yao's station">
<meta property="og:description" content="关于图像特征提取的几个小栗子:">
<meta property="og:image" content="http://yoursite.com/images/Feature_extraction_ex/output_3_1.png">
<meta property="og:image" content="http://yoursite.com/images/Feature_extraction_ex/output_5_0.png">
<meta property="og:image" content="http://yoursite.com/images/Feature_extraction_ex/surf_exm.jpg">
<meta property="og:image" content="http://yoursite.com/images/Feature_extraction_ex/SIFT_features.jpg">
<meta property="og:image" content="http://yoursite.com/images/Feature_extraction_ex/SURF_features.jpg">
<meta property="og:updated_time" content="2017-12-26T07:49:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Image Feature extraction example | Yao's station">
<meta name="twitter:description" content="关于图像特征提取的几个小栗子:">
<meta name="twitter:image" content="http://yoursite.com/images/Feature_extraction_ex/output_3_1.png">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/archive.css">
    <link rel="stylesheet" href="/css/china-social-icon.css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">Yao&#39;s station</a></h1>
        <hr class="panel-cover__divider" />

        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title">Image Feature extraction example</h1>

    

    <div class="post-meta">
      <time datetime="2017-12-26" class="post-meta__date date">2017-12-26</time> 

      <span class="post-meta__tags tags">

          
            <font class="categories">
            &#8226; 分类:
            <a class="categories-link" href="/categories/Feature-extraction/">Feature extraction</a>
            </font>
          

          
             &#8226; 标签:
            <font class="tags">
              <a class="tags-link" href="/tags/Image-processing/">Image processing</a>
            </font>
          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p>关于图像特征提取的几个小栗子: </p>
<a id="more"></a>
<h1 id="Feature-extraction-ex1"><a href="#Feature-extraction-ex1" class="headerlink" title="Feature_extraction_ex1"></a>Feature_extraction_ex1</h1><p>以下是几个关于图像特征提取的小栗子:</p>
<h2 id="识别手写数字"><a href="#识别手写数字" class="headerlink" title="识别手写数字"></a>识别手写数字</h2><p>关于的手写数字识别的OCR问题，通过图像的像素矩阵扁平化来学习手写数字特征。(非常耗费资源)<br>scikit-learn的digits数字集包括至少1700种0-9的手写数字图像。每个图像都有8x8像像素构成。每个像素的值是0-16，白色是0，黑色是16。如下图所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">%matplotlib inline</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</div><div class="line"></div><div class="line">digits = datasets.load_digits()</div><div class="line">print(<span class="string">'Digits: '</span>, digits.target[<span class="number">0</span>])</div><div class="line"><span class="comment"># 8x8像像素构成。每个像素的值是0-16</span></div><div class="line">print(digits.images[<span class="number">0</span>].reshape(<span class="number">-1</span>))</div><div class="line">plt.figure()</div><div class="line">plt.axis(<span class="string">'off'</span>)</div><div class="line">plt.imshow(digits.images[<span class="number">0</span>], cmap=plt.cm.gray_r, interpolation=<span class="string">'nearest'</span>)</div><div class="line">plt.show()</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Digits:  0</div><div class="line">[  0.   0.   5.  13.   9.   1.   0.   0.   0.   0.  13.  15.  10.  15.   5.</div><div class="line">   0.   0.   3.  15.   2.   0.  11.   8.   0.   0.   4.  12.   0.   0.   8.</div><div class="line">   8.   0.   0.   5.   8.   0.   0.   9.   8.   0.   0.   4.  11.   0.   1.</div><div class="line">  12.   7.   0.   0.   2.  14.   5.  10.  12.   0.   0.   0.   0.   6.  13.</div><div class="line">  10.   0.   0.   0.]</div></pre></td></tr></table></figure>
<p><img src="/images/Feature_extraction_ex/output_3_1.png" alt="output_3_1"></p>
<h2 id="scikit-image库抽取下图的兴趣点："><a href="#scikit-image库抽取下图的兴趣点：" class="headerlink" title="scikit-image库抽取下图的兴趣点："></a>scikit-image库抽取下图的兴趣点：</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> skimage.feature <span class="keyword">import</span> corner_harris, corner_peaks</div><div class="line"><span class="keyword">from</span> skimage.color <span class="keyword">import</span> rgb2gray</div><div class="line"><span class="keyword">import</span> skimage.io <span class="keyword">as</span> io</div><div class="line"><span class="keyword">from</span> skimage.exposure <span class="keyword">import</span> equalize_hist</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_corners</span><span class="params">(corners, image)</span>:</span></div><div class="line">    fig = plt.figure()</div><div class="line">    plt.gray()</div><div class="line">    plt.imshow(image)</div><div class="line">    y_corner, x_corner = zip(*corners)</div><div class="line">    plt.plot(x_corner, y_corner, <span class="string">'or'</span>)</div><div class="line">    plt.xlim(<span class="number">0</span>, image.shape[<span class="number">1</span>])</div><div class="line">    plt.ylim(image.shape[<span class="number">0</span>], <span class="number">0</span>)</div><div class="line">    fig.set_size_inches(np.array(fig.get_size_inches()) * <span class="number">1.5</span>)</div><div class="line">    plt.show()</div><div class="line">    </div><div class="line">mandrill = io.imread(<span class="string">'mandrill.jpeg'</span>)</div><div class="line"><span class="comment"># 直方图均衡化</span></div><div class="line">mandrill = equalize_hist(rgb2gray(mandrill))</div><div class="line"><span class="comment"># harris 角点检测</span></div><div class="line">corners = corner_peaks(corner_harris(mandrill), min_distance=<span class="number">2</span>)</div><div class="line">show_corners(corners, mandrill)</div></pre></td></tr></table></figure>
<p><img src="/images/Feature_extraction_ex/output_5_0.png" alt="output_5_0"></p>
<h2 id="用mahotas库来应用SURF方法处理下面的图片"><a href="#用mahotas库来应用SURF方法处理下面的图片" class="headerlink" title="用mahotas库来应用SURF方法处理下面的图片"></a>用mahotas库来应用SURF方法处理下面的图片</h2><p>引入兴趣点提取方法，通过SIFT和SURF进行优化。<br>Mahotas 是计算机视觉和图像处理 Python 库。它包含大量图像处理算法，C++实现形式，提高了性能。完全基于 numpy 的数组作为它的数据类型，有一个非常干净的Python 算法接口。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> mahotas <span class="keyword">as</span> mh</div><div class="line"><span class="keyword">from</span> mahotas.features <span class="keyword">import</span> surf</div><div class="line"></div><div class="line">image = mh.imread(<span class="string">'mandrill.jpeg'</span>, as_grey=<span class="keyword">True</span>)</div><div class="line">print(<span class="string">'第一个SURF描述符: \n&#123;&#125;\n'</span>.format(surf.surf(image)[<span class="number">0</span>]) )</div><div class="line">print(<span class="string">'抽取了%s个SURF描述符'</span> % len(surf.surf(image)))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">第一个SURF描述符: </div><div class="line">[  4.88720413e+01   1.24800860e+02   1.93404140e+00   4.69215836e+02</div><div class="line">   1.00000000e+00  -1.89817090e+00  -9.16485838e-04   4.15829239e-04</div><div class="line">   1.62917514e-03   4.50508786e-03   2.16965117e-03  -1.54517486e-02</div><div class="line">   1.19871085e-02   2.27849309e-02  -4.96764299e-03  -2.30153165e-03</div><div class="line">   1.24213881e-02   9.73558091e-03   1.01124633e-03   9.33727930e-05</div><div class="line">   1.50382252e-03   4.28077728e-04   4.12196201e-04   2.63136511e-03</div><div class="line">   1.47364160e-02   2.57975865e-02   2.13572331e-01   1.36266382e-03</div><div class="line">   3.25871891e-01   2.83610749e-01   3.01434634e-01  -8.35839666e-02</div><div class="line">   4.67635391e-01   1.61936283e-01   6.27416198e-03  -4.75608140e-03</div><div class="line">   6.38395923e-02   2.88552374e-02   4.36529968e-03   1.22763937e-02</div><div class="line">   4.28753085e-02   2.97861362e-02  -1.65692866e-01  -3.00393938e-02</div><div class="line">   3.07613402e-01   2.59695442e-01  -1.77392860e-01  -8.42926232e-02</div><div class="line">   3.22241967e-01   2.68252184e-01   1.22916451e-02  -2.17223444e-03</div><div class="line">   3.34867018e-02   7.92410354e-03  -3.77849533e-04  -3.75246341e-03</div><div class="line">   5.13159418e-03   4.26743799e-03   2.47661732e-02  -9.75867100e-03</div><div class="line">   3.38654071e-02   2.22350151e-02   1.25097158e-02  -5.13047076e-03</div><div class="line">   6.62972574e-02   3.98549144e-02   7.56108237e-03   4.19496163e-04</div><div class="line">   1.53695063e-02   5.35408794e-03]</div><div class="line"></div><div class="line">抽取了222个SURF描述符</div></pre></td></tr></table></figure>
<h2 id="数据标准化"><a href="#数据标准化" class="headerlink" title="数据标准化"></a>数据标准化</h2><p>scikit-learn的scale函数实现:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> preprocessing</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">X = np.array([</div><div class="line">    [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">5.</span>, <span class="number">13.</span>, <span class="number">9.</span>, <span class="number">1.</span>],</div><div class="line">    [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">13.</span>, <span class="number">15.</span>, <span class="number">10.</span>, <span class="number">15.</span>],</div><div class="line">    [<span class="number">0.</span>, <span class="number">3.</span>, <span class="number">15.</span>, <span class="number">2.</span>, <span class="number">0.</span>, <span class="number">11.</span>]</div><div class="line">])</div><div class="line">print(preprocessing.scale(X))</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[[ 0.         -0.70710678 -1.38873015  0.52489066  0.59299945 -1.35873244]</div><div class="line"> [ 0.         -0.70710678  0.46291005  0.87481777  0.81537425  1.01904933]</div><div class="line"> [ 0.          1.41421356  0.9258201  -1.39970842 -1.4083737   0.33968311]]</div></pre></td></tr></table></figure>
<h2 id="OpenCV-SURF-特征提取"><a href="#OpenCV-SURF-特征提取" class="headerlink" title="OpenCV SURF() 特征提取"></a>OpenCV SURF() 特征提取</h2><p>KeyPoint 数据结构</p>
<ul>
<li>angle：角度，表示关键点的方向</li>
<li>class_id：当要对图片进行分类时，我们可以用class_id对每个特征点进行区分，未设定时为-1</li>
<li>octave：代表是从金字塔哪一层提取的得到的数据。</li>
<li>pt：关键点点的坐标  —-这次用到的</li>
<li>response：响应程度，代表该点强壮大小; response代表着该关键点how good，更确切的说，是该点角点的程度。</li>
<li>size：该点直径的大小</li>
</ul>
<p>注意一个问题：keypoint只是保存了opencv的sift库检测到的特征点的一些基本信息，也就上面所说的这些，但sift所提取出来的特征向量其实不是在这个里面，特征向量通过SiftDescriptorExtractor 提取，结果放在一个Mat的数据结构中。这个数据结构才真正保存了该特征点所对应的特征向量。具体见后文对SiftDescriptorExtractor 所生成的对象的详解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> cv2</div><div class="line"></div><div class="line">image = cv2.imread(<span class="string">'surf_exm.jpg'</span>)</div><div class="line">image2 = image.copy()</div><div class="line"><span class="comment">#cv2.imshow('original', image)</span></div><div class="line"><span class="comment">#cv2.waitKey()</span></div><div class="line"></div><div class="line"><span class="comment"># 下采样</span></div><div class="line"><span class="comment"># 高斯图像金字塔</span></div><div class="line"><span class="comment">#im_lowers = cv2.pyrDown(image) </span></div><div class="line"><span class="comment">#cv2.imshow('imlowers', im_lowers)</span></div><div class="line"></div><div class="line"><span class="comment"># 检测特征点</span></div><div class="line"><span class="comment"># 调用SIFT</span></div><div class="line"><span class="comment"># opencv将SIFT等算法整合到xfeatures2d集合里面了。变更后写法如下：</span></div><div class="line">s = cv2.xfeatures2d.SIFT_create()</div><div class="line"></div><div class="line">keypoints = s.detect(image)</div><div class="line"><span class="comment"># type(keypoints)  &lt;class 'list'&gt;</span></div><div class="line"><span class="comment"># len(keypoints)   6212</span></div><div class="line"></div><div class="line"><span class="comment"># 显示特征点</span></div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> keypoints:</div><div class="line">    cv2.circle(image, (int(k.pt[<span class="number">0</span>]), int(k.pt[<span class="number">1</span>])), <span class="number">1</span>, (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">-1</span>)</div><div class="line">    </div><div class="line">s1 = cv2.xfeatures2d.SURF_create()</div><div class="line">keypoints2 = s1.detect(image)</div><div class="line"></div><div class="line"><span class="keyword">for</span> kk <span class="keyword">in</span> keypoints2:</div><div class="line">    <span class="comment"># circle 函数 (指针, 圆心坐标, 圆半径, 颜色, thickness正数表示组成圆的线条的粗细程度;否则，表示圆是否被填充</span></div><div class="line">    cv2.circle(image2, (int(kk.pt[<span class="number">0</span>]), int(kk.pt[<span class="number">1</span>])), <span class="number">1</span>, (<span class="number">0</span>, <span class="number">255</span>, <span class="number">0</span>), <span class="number">-1</span>)</div><div class="line">    <span class="comment">#cv2.circle(image2, (int(kk.pt[0]), int(kk.pt[1])), int(k.size), (0, 255, 0), -1)</span></div><div class="line"></div><div class="line">cv2.imwirte(<span class="string">'SIFT_features.jpg'</span>,image)</div><div class="line">cv2.imwrite(<span class="string">'SURF_features.jpg'</span>,image2)</div><div class="line">cv2.waitKey()</div></pre></td></tr></table></figure>
<p><strong>原图:</strong></p>
<p><img src="/images/Feature_extraction_ex/surf_exm.jpg" alt="surf_exm"></p>
<p><strong>SIFT:</strong></p>
<p><img src="/images/Feature_extraction_ex/SIFT_features.jpg" alt="SIFT_features"></p>
<p><strong>SURF:</strong></p>
<p><img src="/images/Feature_extraction_ex/SURF_features.jpg" alt="SURF_features"></p>

  </section>

  
  

<section class="post-comments">

    <div class="ds-thread" data-thread-key="2017/12/26/图像特征提取实例/"></div>

    <script type="text/javascript">
      var duoshuoQuery = {short_name:"Sixdes"};
      (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
        || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
    </script> 

</section>


  
<section class="post-comments">
    <div class="ds-thread" data-thread-key="2017/12/26/图像特征提取实例/"></div>
        <div id="uyan_frame"></div>
			<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2130959"></script>
</section>



</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
